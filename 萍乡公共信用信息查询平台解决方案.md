#服务器架构解决方案

---

现有服务器:

1. 平台数据库服务器 * 2
2. 平台应用服务器
3. 网站数据库服务器
4. 网站web服务器
5. 平台应急服务器
6. 网站应急服务器
7. 测试服务器
8. 备份服务器
9. 存储

考虑到实际扩展决定采用以下技术方案

1. rancher
2. docker

使用了docker可以在一台服务器内隔离不同的应用场景,且作为平台应用也可以很友善的接入.

针对旧环境的应用也能很友善的处理和扩展(比如旧的程序使用低版本的环境),可以使用容器单独隔离部署.

这样首先

1. 平台数据库服务器+网站数据库服务器凑成3台,做主+2从 方案,如果需要使用memcached或者no-sql,可以统一部署到这3台服务器内(32G内存足够)
2. 网站web服务器+网站应急服务器+平台应用服务器,凑成3台服务器作为高可用
3. 平台应急服务器作为rancher的server端,单独部署.同时作为镜像仓库服务器.
4. 测试服务器单独,jenkins作为测试使用
5. 备份服务器单独
6. 存储服务器考虑作为附件服务器


这样我们既可以做到系统自愈(服务器运行错误可以自行启动恢复),高可用,以及环境的隔离.

###额外增加的服务器

####缓存服务器

部署`redis`,`memcached`等缓存服务

需求`数据库服务器配置` * 3 = 300k


####数据采集服务器

需求`程序服务器` * 2 = 135k

####数据搜索服务器

部署分布式搜索服务`Elastic Search` 

需求`数据库服务器配置` * 3 = 300k

####数据分析服务器

部署数据分析服务 * 5

需求`数据库服务器配置` * 5 = 500k

#####总数

1235k

###人员配置

**运维人员** 

负责服务器的维护使用,需要`2`人.大约 18K *2 = 36k

**DBA**

负责数据库维护和使用,需要`1`人.大约 18k*1 = 18k

**UI/设计**

负责UI设计,需要`4`人.大约 15k*4 = 60k

**前端工程师**

负责web端前端开发工作,需要`5`人.大约 18k*5 = 90k

**架构师**

35k,需要`1`人.大约 35K*1 = 35k

**php(暂定php)程序**

需要程序,需要`20`人.大约 20k*20 = 400k

**测试工程师**

10k,需要`5`人.大约10k*5 = 50k

**网络安全工程师**

15k,需要`2`人 = 30k

**产品需求分析师**

15k,需要`5`人 = 75k

**大数据**

20k,需要`5`人,约20k*5 = 100k

**数据采集工程师**

15k,需要`5`人,约15k*5 = 75k

###总结

**前期调研**

住宿每人成本`500`每天,需要1个月,按照31天计算 = 15.5k

需要`8`人(技术和需求分析师)

8 * 15.5 = 124k

**开发成本**

每个月`969`

`969` * 6(6个月开发时间) = 5814

**维护成本**

* 程序 2 人 = 20k * 2
* 测试 1 人 = 10k * 1
* 运维 1 人 = 18k * 1
* DBA 1 人 = 18k * 1
* 数据分析 1 人 = 20k * 1
* 产品需求分析师 1 人 = 15k * 1
* 数据采集工程师 1 人 = 15k * 1

总数 = 136k * 6(6个月) = 816k

**总成本**

开发(`5814k`) + 增加的硬件(`1235k`) + 维护(`816k`) = 7865k
